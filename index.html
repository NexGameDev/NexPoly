<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Mini Monopoly - Generic Board</title>
<style>
  :root{
    --bg:#071226; --card:#f8fafc; --muted:#9aa6b2; --accent:#f59e0b;
    --owner-a:#ef4444; --owner-b:#3b82f6; --owner-c:#10b981; --owner-d:#a78bfa;
    --board-max:980px;
    --cell-min:44px; /* ensures tap targets on small phones */
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial; background:linear-gradient(#071226,#051423); color:#eaf2ff;-webkit-font-smoothing:antialiased}
  .wrap{max-width:var(--board-max); margin:12px auto; padding:10px; display:grid; grid-template-columns: 1fr 320px; gap:12px;}
  @media (max-width:920px){ .wrap{grid-template-columns:1fr; padding:8px} }

  /* Board container scales to width, never zooms; grid is fixed 11x11 */
  .board-wrap{width:100%; overflow:auto}
  .board{width:100%; max-width:100%; aspect-ratio:1/1; display:grid; grid-template-columns:repeat(11,1fr); grid-template-rows:repeat(11,1fr); gap:6px; background:linear-gradient(180deg,#0b1724,#071226); padding:8px; border-radius:10px;}
  .cell{background:linear-gradient(180deg,#082033,#071226); border-radius:6px; padding:4px; font-size:11px; color:#dbeafe; display:flex; flex-direction:column; justify-content:space-between; min-width:var(--cell-min); min-height:var(--cell-min)}
  .corner{background:linear-gradient(180deg,#0f2638,#071226); font-weight:800; font-size:12px; display:flex; align-items:center; justify-content:center; text-align:center}
  .edge-title{font-weight:700; font-size:11px; line-height:1; transform-origin:center; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
  .prop-bar{height:8px; border-radius:4px; margin-bottom:6px; width:100%}
  .price{font-size:11px; color:var(--muted)}
  .players-on{display:flex; gap:4px; margin-top:6px; flex-wrap:wrap}
  .pawn{width:16px;height:16px;border-radius:50%;display:inline-block;border:2px solid #071226}

  /* Sidebar */
  .panel{background:linear-gradient(180deg,#061425,#041226); border-radius:10px; padding:12px; min-height:calc(100% - 24px)}
  .players-list{display:flex; flex-direction:column; gap:8px; margin-bottom:10px}
  .player{display:flex; align-items:center; gap:8px; padding:8px; border-radius:8px; background:rgba(255,255,255,0.02)}
  .player.active{outline:2px solid rgba(255,255,255,0.04)}
  .controls{display:flex; gap:8px; margin-bottom:10px; flex-wrap:wrap}
  button{background:var(--accent); border:none; color:#071226; font-weight:700; padding:8px 10px; border-radius:8px; cursor:pointer; font-size:14px}
  button.alt{background:transparent; color:var(--card); border:1px solid rgba(255,255,255,0.06)}
  .log{background:rgba(255,255,255,0.02); padding:8px; height:200px; overflow:auto; border-radius:8px; font-size:13px; color:#cbe7ff}
  .small{font-size:13px; color:var(--muted)}
  .prop-list{margin-top:8px; font-size:13px; color:var(--muted)}

  /* rotate text for edge cells (top/right/bottom/left) */
  .edge-vertical { writing-mode:vertical-rl; transform:rotate(180deg); text-align:center; }
  .edge-horizontal { text-align:center; }
  .cell.clickable { cursor:pointer; }
  /* ensure tap targets comfortable on mobile */
  @media (max-width:420px){
    .pawn{width:14px;height:14px}
    .player { padding:6px }
    button{padding:8px 8px; font-size:13px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="board-wrap">
      <div class="board" id="board" aria-hidden="false"></div>
    </div>

    <aside class="panel" aria-label="Game panel">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <h3 style="margin:0">Mini Monopoly</h3>
        <div class="small">Generic â€¢ Mobile-ready</div>
      </div>

      <div class="players-list" id="playersList"></div>

      <div class="controls">
        <button id="rollBtn">Roll Dice</button>
        <button id="buyBtn" class="alt">Buy</button>
        <button id="endBtn" class="alt">End Turn</button>
      </div>

      <div class="small">Dice: <strong id="dice">-</strong></div>
      <div class="small">Turn: <strong id="turn">-</strong></div>
      <div class="small" style="margin-bottom:8px">Bank: <strong id="bank">Rp 0</strong></div>

      <div style="margin-top:8px; font-weight:700">Tile Info</div>
      <div id="propInfo" class="prop-list">Tap a tile or land on it to view details.</div>

      <div style="margin-top:10px; font-weight:700">Log</div>
      <div class="log" id="log"></div>
    </aside>
  </div>

<script>
/* Mini Monopoly - 40 tiles around an 11x11 grid.
   Generic property names: Property 1..40
   Simple rules: roll two d6, pass GO +200, buy, pay rent, bankrupt elimination.
*/

const maxPos = 40;
const boardEl = document.getElementById('board');
const logEl = document.getElementById('log');

/* players (2 active by default). Uncomment more for up to 4. */
const players = [
  {id:0,name:'Player 1',color:getComputedStyle(document.documentElement).getPropertyValue('--owner-a').trim() || '#ef4444',pos:0,money:1500,alive:true},
  {id:1,name:'Player 2',color:getComputedStyle(document.documentElement).getPropertyValue('--owner-b').trim() || '#3b82f6',pos:0,money:1500,alive:true},
  // {id:2,name:'Player 3',color:getComputedStyle(document.documentElement).getPropertyValue('--owner-c').trim() || '#10b981',pos:0,money:1500,alive:true},
  // {id:3,name:'Player 4',color:getComputedStyle(document.documentElement).getPropertyValue('--owner-d').trim() || '#a78bfa',pos:0,money:1500,alive:true},
];

let currentTurn = 0;
let diceValue = 0;
const bank = {money:999999};

/* create 40 generic tiles */
const properties = Array.from({length:maxPos}, (_,i)=> {
  return {
    id:i,
    name: i===0 ? 'GO' : `Property ${i}`,
    price: i===0 ? 0 : 100 + (i*5), // varied prices
    rent: i===0 ? 0 : Math.max(10, Math.floor((100 + (i*5)) / 6)),
    owner: null,
    pos: i
  };
});

/* Render 11x11 grid empties */
function makeGrid(){
  boardEl.innerHTML = '';
  for(let r=0;r<11;r++){
    for(let c=0;c<11;c++){
      const div = document.createElement('div');
      div.className = 'cell';
      boardEl.appendChild(div);
    }
  }
}
makeGrid();

/* build coords mapping for edges (40 positions) */
function edgeCoords(){
  const coords = [];
  for(let x=0;x<11;x++) coords.push([0,x]);           // top row 0..10 (11)
  for(let y=1;y<11;y++) coords.push([y,10]);         // right col 1..10 (10)
  for(let x=9;x>=0;x--) coords.push([10,x]);         // bottom row 9..0 (10)
  for(let y=9;y>=1;y--) coords.push([y,0]);          // left col 9..1 (9)
  // coords length = 40
  return coords;
}
const coords = edgeCoords();
const posToIndex = coords.map(([r,c])=> r*11 + c);

/* render board tiles (text orientation adapted per side) */
function renderBoard(){
  const cells = boardEl.querySelectorAll('.cell');
  cells.forEach((cell,i)=> {
    cell.innerHTML = '';
    cell.classList.remove('corner');
    cell.classList.remove('clickable');
  });

  for(let i=0;i<coords.length && i<maxPos;i++){
    const gridIndex = posToIndex[i];
    const el = boardEl.children[gridIndex];
    el.innerHTML = '';
    el.classList.add(i%10===0 ? 'corner' : '');
    // title (rotate orientation based on side)
    const side = determineSide(i); // 'top','right','bottom','left'
    const title = document.createElement('div');
    title.className = (side==='top' || side==='bottom') ? 'edge-horizontal edge-title' : 'edge-vertical edge-title';
    title.textContent = properties[i].name;
    el.appendChild(title);

    if(properties[i].price>0){
      const bar = document.createElement('div');
      bar.className='prop-bar';
      bar.style.background = '#334155';
      el.appendChild(bar);
      const price = document.createElement('div');
      price.className='price';
      price.textContent = 'Rp ' + properties[i].price;
      el.appendChild(price);
    } else {
      const info = document.createElement('div');
      info.className='small';
      info.textContent = 'Collect Rp 200 on pass';
      el.appendChild(info);
    }

    const playersHere = document.createElement('div');
    playersHere.className='players-on';
    playersHere.dataset.pos = i;
    el.appendChild(playersHere);

    el.classList.add('clickable');
    el.addEventListener('click', ()=> showProp(i));
  }

  updatePlayersOnBoard();
}

/* simple side determination */
function determineSide(pos){
  // top: 0..10
  if(pos>=0 && pos<=10) return 'top';
  if(pos>10 && pos<=20) return 'right';
  if(pos>20 && pos<=30) return 'bottom';
  return 'left';
}

/* render players sidebar */
const playersListEl = document.getElementById('playersList');
function renderPlayersList(){
  playersListEl.innerHTML='';
  players.forEach(p=>{
    const d = document.createElement('div');
    d.className = 'player' + (currentTurn===p.id ? ' active' : '');
    d.innerHTML = `<div style="width:18px;height:18px;border-radius:50%;background:${p.color};border:2px solid #071226"></div>
                   <div style="flex:1">
                     <div style="font-weight:700;font-size:14px">${p.name}</div>
                     <div class="small">Rp ${p.money}</div>
                   </div>
                   <div class="small">Pos: ${p.pos}</div>`;
    playersListEl.appendChild(d);
  });
  document.getElementById('turn').textContent = players[currentTurn] ? players[currentTurn].name : '-';
  document.getElementById('bank').textContent = 'Rp ' + bank.money;
}

/* players on board visuals */
function updatePlayersOnBoard(){
  const playersOnEls = boardEl.querySelectorAll('.players-on');
  playersOnEls.forEach(el=> el.innerHTML='');
  players.forEach(p=>{
    if(!p.alive) return;
    const pos = p.pos % maxPos;
    const gridIndex = posToIndex[pos];
    const cell = boardEl.children[gridIndex];
    if(!cell) return;
    const playersOn = cell.querySelector('.players-on');
    if(playersOn){
      const pawn = document.createElement('span');
      pawn.className='pawn';
      pawn.style.background = p.color;
      pawn.title = p.name;
      playersOn.appendChild(pawn);
    }
  });
}

/* show tile info */
function showProp(i){
  const prop = properties[i];
  const el = document.getElementById('propInfo');
  el.innerHTML = `<div style="font-weight:700">${prop.name}</div>
                  <div class="small">Price: Rp ${prop.price} â€¢ Rent: Rp ${prop.rent}</div>
                  <div style="margin-top:6px">${prop.owner===null ? 'Unowned' : 'Owned by ' + (players.find(p=>p.id===prop.owner)?.name || 'Unknown')}</div>
                  <div style="margin-top:6px" class="small">Index: ${i}</div>`;
}

/* logging helper */
function log(text){
  const p = document.createElement('div');
  p.textContent = text;
  logEl.appendChild(p);
  logEl.scrollTop = logEl.scrollHeight;
}

/* actions */
function rollDice(){
  const p = players[currentTurn];
  if(!p || !p.alive) return;
  diceValue = (Math.floor(Math.random()*6)+1) + (Math.floor(Math.random()*6)+1);
  document.getElementById('dice').textContent = diceValue;
  log(`${p.name} rolled ${diceValue}`);
  movePlayer(currentTurn, diceValue);
  renderPlayersList();
}

function movePlayer(pid, steps){
  const p = players[pid];
  const prev = p.pos;
  p.pos = (p.pos + steps) % maxPos;
  // passed GO detection
  if(prev + steps >= maxPos || p.pos < prev) { p.money += 200; log(`${p.name} passed GO and collected Rp 200`); }
  updatePlayersOnBoard();
  const landed = properties[p.pos];
  if(landed.price === 0){
    log(`${p.name} landed on ${landed.name}.`);
  } else if(landed.owner === null){
    log(`${p.name} landed on ${landed.name} â€” available for Rp ${landed.price}.`);
  } else if(landed.owner === p.id){
    log(`${p.name} landed on their own ${landed.name}.`);
  } else {
    const owner = players.find(pl => pl.id === landed.owner);
    const rent = landed.rent;
    p.money -= rent;
    owner.money += rent;
    log(`${p.name} paid Rp ${rent} rent to ${owner.name} (${landed.name}).`);
    checkBankrupt(p);
  }
  renderPlayersList();
}

/* buy current tile */
function buyCurrent(){
  const p = players[currentTurn];
  if(!p || !p.alive) return;
  const prop = properties[p.pos];
  if(prop.price===0){ log('Cannot buy GO.'); return; }
  if(prop.owner !== null){ log('Property already owned.'); return; }
  if(p.money >= prop.price){
    p.money -= prop.price;
    prop.owner = p.id;
    log(`${p.name} bought ${prop.name} for Rp ${prop.price}.`);
    renderPlayersList();
    showProp(p.pos);
  } else {
    log(`${p.name} cannot afford ${prop.name}.`);
  }
}

/* end turn: next alive player */
function endTurn(){
  const total = players.length;
  let next = currentTurn;
  for(let i=1;i<=total;i++){
    const cand = (currentTurn + i) % total;
    if(players[cand].alive){ next = cand; break; }
  }
  currentTurn = next;
  renderPlayersList();
  log(`Turn: ${players[currentTurn].name}`);
}

/* bankruptcy */
function checkBankrupt(player){
  if(player.money < 0){
    player.alive = false;
    properties.forEach(prop => { if(prop.owner === player.id) prop.owner = null; });
    log(`${player.name} went bankrupt and is eliminated.`);
    const alive = players.filter(p=>p.alive);
    if(alive.length === 1){
      log(`ðŸ† ${alive[0].name} wins!`);
      document.getElementById('rollBtn').disabled = true;
      document.getElementById('buyBtn').disabled = true;
      document.getElementById('endBtn').disabled = true;
    } else {
      if(!players[currentTurn].alive) endTurn();
    }
  }
}

/* ui hooks */
document.getElementById('rollBtn').addEventListener('click', ()=> rollDice());
document.getElementById('buyBtn').addEventListener('click', ()=> buyCurrent());
document.getElementById('endBtn').addEventListener('click', ()=> endTurn());

/* init */
renderBoard();
renderPlayersList();
log('Game ready â€” tap Roll Dice to play.');
showProp(0);
</script>
</body>
</html>
